# 06 - Evaluaci√≥n de Vulnerabilidades (Vulnerability Assessment) üïµÔ∏è‚Äç‚ôÇÔ∏è

> **üéØ Objetivo:** Dejar√°s de ver los datos como simples n√∫meros en una pantalla. Aprender√°s a pensar como un analista que conecta el pasado, presente y futuro para predecir fallos de seguridad, y entender√°s la diferencia crucial entre "ganar un juego" (CTF) y "proteger una empresa" (Pentest real).

---

## 1. El Cerebro detr√°s del M√∫sculo: El Proceso de An√°lisis

Ya pasaste la fase de **Information Gathering** (Recolecci√≥n de Informaci√≥n). Tienes gigabytes de datos, IPs, puertos y nombres. ¬øY ahora qu√©? Ahora empieza el verdadero trabajo mental.

La **Evaluaci√≥n de Vulnerabilidades** no es lanzar un esc√°ner y esperar; es un proceso anal√≠tico. Imagina que eres un m√©dico. Los datos (fiebre, dolor) son la recolecci√≥n. El **an√°lisis** es cuando te sientas, miras el historial y decides qu√© enfermedad es y c√≥mo curarla.

El an√°lisis es complejo porque jugamos con tres tiempos: **Pasado, Presente y Futuro**. Para no perdernos, utilizamos 4 tipos de an√°lisis que debes dominar:

|**Tipo de An√°lisis**|**La Pregunta Clave**|**Analog√≠a M√©dica ü©∫**|**En Ciberseguridad üíª**|
|---|---|---|---|
|**Descriptivo**|_¬øQu√© pas√≥ / Qu√© hay?_|"El paciente tiene 39¬∞ de fiebre."|Detectamos un puerto 80 abierto y un error 404 en los logs. Describe el "ahora".|
|**Diagn√≥stico**|_¬øPor qu√© pas√≥?_|"La fiebre es causada por una infecci√≥n viral."|Investigamos _por qu√©_ fall√≥ el servidor. Buscamos causas y correlaciones mirando hacia atr√°s.|
|**Predictivo**|_¬øQu√© pasar√°?_|"Si no tratamos esto, la fiebre subir√° ma√±ana."|Basado en datos hist√≥ricos y actuales, creamos un modelo. "Si este puerto sigue abierto sin parche, seremos hackeados".|
|**Prescriptivo**|_¬øQu√© hacemos?_|"Tome este antibi√≥tico cada 8 horas."|Define la acci√≥n exacta para eliminar el problema o detonar un proceso de defensa.|

---

## 2. Sherlock Holmes y el Misterio del Puerto 2121 üîç

Aqu√≠ es donde aplicamos la l√≥gica. Estudiemos un escenario cl√°sico: Nmap encuentra el puerto TCP 2121 abierto.

Nmap solo te dice el puerto y no dice nada m√°s. Un novato se quedar√≠a bloqueado. T√∫ no. T√∫ te haces preguntas para separar lo que VES de lo que TIENES.

### El Proceso Deductivo (Paso a Paso)

1. **Lo que ves:** Puerto 2121/TCP abierto.
    
2. **Lo que sabes (Tu base de datos mental):**
    
    - _¬øEs un puerto est√°ndar?_ No. Los puertos "System" o "Well-known" van del 0 al 1023.
        
    - _¬øMe suena familiar?_ S√≠. Se parece sospechosamente al puerto **21** (FTP).
        
    - _Psicolog√≠a del Admin:_ Los administradores a menudo intentan "esconder" servicios movi√©ndolos de puerto, pero son perezosos o quieren recordarlo f√°cil. Mueven SSH del 22 al 2222, o FTP del 21 al 2121.
        

> **üí° Nota:** A esto se le llama "Seguridad por Oscuridad" (Security by Obscurity). Spoiler: No funciona contra un buen hacker.

### La Prueba de Fuego (Testing Manual)

No asumimos, verificamos.

Intentamos conectarnos con netcat o un cliente FTP a ese puerto:

`nc -nv <IP> 2121`

El detalle cr√≠tico de los 15 segundos ‚è±Ô∏è

Imagina que al conectarte, la terminal se queda "pensando" y tarda 15 segundos en responderte con el banner de bienvenida del FTP.

- **Conclusi√≥n 1:** ¬°Es un FTP! Tu deducci√≥n fue correcta.
    
- **Conclusi√≥n 2 (Nivel Pro):** Esa tardanza explica por qu√© quiz√°s tus escaneos autom√°ticos anteriores fallaron o dieron resultados raros. Nmap a veces se rinde si el puerto tarda mucho en responder.
    
- **Acci√≥n Correctiva:** Ahora que sabes que el servidor es "lento", puedes reconfigurar tu esc√°ner (Nmap) ajustando el `--min-rtt-timeout` (Tiempo m√≠nimo de ida y vuelta) a 15 o 20 segundos.
    

> **üõ°Ô∏è Nota de Seguridad:** Entender el comportamiento del servicio (como su lentitud) te permite afinar tus herramientas para que no se les escape nada en la siguiente pasada.

---

## 3. Investigaci√≥n de Vulnerabilidades (Vulnerability Research) üìö

Ya sabemos qu√© componentes tenemos (An√°lisis Descriptivo). Ahora buscamos si est√°n "rotos".

Si identificaste que corre Apache 2.4.49, vas a las bases de datos mundiales a buscar si existe un CVE (Common Vulnerabilities and Exposures) para esa versi√≥n.

**Tus "Biblias" de consulta:**

- **NIST NVD:** La base oficial.
    
- **Exploit DB:** Donde viven los exploits reales.
    
- **Packet Storm Security:** Noticias y exploits frescos.
    
- **CVE Details & Vulners:** Buscadores r√°pidos.
    

### Del Papel a la Realidad: El POC

Si encuentras una vulnerabilidad, a menudo vendr√° con un POC (Proof-of-Concept).

Aqu√≠ es donde entra el An√°lisis Diagn√≥stico.

> ‚ö†Ô∏è Advertencia Importante: Un POC no es un "bot√≥n m√°gico de hackeo".
> 
> Un POC es c√≥digo escrito por otra persona para un entorno espec√≠fico. A menudo, tendr√°s que leer el c√≥digo, entender c√≥mo funciona la vulnerabilidad y modificar el exploit (cambiar IPs, payloads, ajustar tiempos) para que funcione en TU objetivo.
> 
> Ser un hacker √©tico requiere saber programar o al menos leer c√≥digo, no solo copiar y pegar.

---

## 4. Evaluaci√≥n de Vectores y el "Espejo Local" ü™û

Entramos en el **An√°lisis Predictivo**. Vamos a probar si la vulnerabilidad es real.

Aqu√≠ tienes dos caminos, dependiendo de las reglas del juego (Engagement Rules):

1. **Ataque Directo:** Pruebas contra el servidor del cliente (si est√° permitido y no es destructivo).
    
2. **Ataque en Espejo (Local Mirroring):**
    
    - _¬øCu√°ndo se usa?_ Cuando el cliente exige **Evasi√≥n** (que no te detecten) o el sistema es cr√≠tico y no puede caerse.
        
    - _¬øC√≥mo se hace?_ Usas la informaci√≥n recolectada para construir una r√©plica exacta del sistema objetivo en tu propia m√°quina virtual (mismo SO, misma versi√≥n de App).
        
    - _La Magia:_ Lanzas tus exploits contra TU copia local. Si funciona all√≠, sabes que funcionar√° en el real sin hacer ruido ni romper nada antes de tiempo.
        

![[local-mirroring.png]]

---

## 5. El Bucle Infinito (The Return) üîÑ

¬øQu√© pasa si analizas todo y no encuentras NADA vulnerable?

No empacas tus cosas y te vas. Regresas a la casilla de salida.

Vuelves a la fase de Information Gathering. Buscas m√°s profundo. Quiz√°s se te pas√≥ un subdominio, o un puerto UDP, o ese puerto 2121 que tardaba mucho en responder.

Estas dos fases (Recolecci√≥n y Evaluaci√≥n) son un baile constante. Vas y vienes hasta encontrar la grieta.

---

## 6. Mentalidad: Pentest Real vs. CTF üèÜ

Este es el consejo m√°s valioso para tu carrera profesional.

- **CTF (Capture The Flag / Hack The Box):**
    
    - **Objetivo:** Velocidad.
        
    - **Mentalidad:** "Entra, consigue root, lee la bandera, siguiente".
        
    - **Realidad:** Si encuentras una entrada, ignoras las otras 5 posibles.
        
- **Pentest Real (Vida Profesional):**
    
    - **Objetivo:** Calidad y Cobertura Total.
        
    - **Mentalidad:** "Necesito encontrar TODAS las formas en que alguien podr√≠a entrar aqu√≠".
        
    - **Riesgo:** Si entras r√°pido y reportas solo eso, y un criminal real entra ma√±ana por otra puerta que ignoraste, fallaste en tu trabajo. Tu cliente paga para conocer **todas** sus debilidades, no solo la m√°s r√°pida.
        

---

### üéì Resumen para llevar

- **Analiza en 4D:** No solo mires el error, diagnostica la causa, predice el impacto y prescribe la soluci√≥n.
    
- **Intuici√≥n + Verificaci√≥n:** Si ves un puerto extra√±o (2121), tu intuici√≥n dice "FTP", pero tu deber es verificarlo manualmente (Netcat).
    
- **Ajusta tus herramientas:** Si descubres que un servicio es lento, ajusta el _timeout_ de tus esc√°neres. No dejes que la herramienta piense por ti.
    
- **Los POCs se editan:** Rara vez un exploit p√∫blico funciona a la primera. Tienes que entender el c√≥digo y adaptarlo.
    
- **No seas un jugador, s√© un profesional:** En un trabajo real, la velocidad importa menos que la exhaustividad. Encuentra hasta el √∫ltimo agujero de seguridad.