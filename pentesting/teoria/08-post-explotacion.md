# 08 - Post-ExplotaciÃ³n: El Arte de Sobrevivir Adentro ğŸ•µï¸â€â™‚ï¸

> **ğŸ¯ Objetivo:** AprenderÃ¡s quÃ© hacer **despuÃ©s** de comprometer un sistema. DescubrirÃ¡s cÃ³mo moverte sin ser detectado, asegurar tu acceso y extraer informaciÃ³n valiosa sin activar las alarmas. Es la diferencia entre entrar por la puerta y ser el dueÃ±o del edificio.

---

### 1. El Nuevo Campo de Juego: Post-ExplotaciÃ³n

La **Post-ExplotaciÃ³n** es donde obtenemos la informaciÃ³n sensible, datos de negocio y privilegios que realmente importan. Ya no estamos golpeando la puerta desde afuera; estamos en la sala de estar.

Esta fase se compone de varios movimientos clave:

1. **Evasive Testing** (Pruebas Evasivas)
    
2. **Information Gathering** (RecolecciÃ³n de InformaciÃ³n)
    
3. **Pillaging** (Saqueo)
    
4. **Vulnerability Assessment** (EvaluaciÃ³n de Vulnerabilidades Internas)
    
5. **Privilege Escalation** (Escalada de Privilegios)
    
6. **Persistence** (Persistencia)
    
7. **Data Exfiltration** (ExfiltraciÃ³n de Datos)

![[post-intrucion-lifecycle.png]]


---

### 2. Pruebas Evasivas: El Modo Ninja ğŸ¥·

Imagina que eres un ladrÃ³n que acaba de entrar a un museo.

- **Si corres gritando y rompiendo vitrinas:** Las alarmas suenan, los guardias (Admins/Blue Team) te atrapan y te expulsan.
    
- **Si caminas despacio y evitas los lÃ¡seres:** Nadie nota que estÃ¡s ahÃ­ hasta que es demasiado tarde.
    

Si un administrador estÃ¡ monitoreando, un comando simple como `net user` o `whoami` puede encender las luces rojas. Los sistemas **EDR** (Endpoint Detection and Response) buscan comportamientos anÃ³malos.

#### Los 3 Estilos de Pruebas

Dependiendo de lo que el cliente necesite, adoptaremos una postura:

|**Tipo de Prueba**|**DescripciÃ³n**|**AnalogÃ­a**|
|---|---|---|
|**Evasiva**|Objetivo: No ser detectado. Se usan tÃ©cnicas sutiles para identificar "puntos ciegos" en la defensa.|El Ninja: Entra, cumple la misiÃ³n y sale sin dejar huella.|
|**No-Evasiva**|Objetivo: Hacer mucho ruido para probarlo todo a fondo. No importa si nos bloquean, queremos ver cuÃ¡nto aguanta el sistema.|El Tanque: Entra rompiendo paredes para ver quÃ© tan fuertes son.|
|**HÃ­brida**|Una mezcla. Usamos tÃ©cnicas ruidosas pero vemos si las defensas reaccionan.|El EspÃ­a Descuidado: Hace ruido a propÃ³sito para ver quiÃ©n viene a investigar.|

> **ğŸ’¡ Nota:** A veces, ser detectado es bueno **si** el objetivo es entrenar al equipo defensivo del cliente. Pero por defecto, intentamos pasar desapercibidos.

---

### 3. RecolecciÃ³n de InformaciÃ³n: La Perspectiva Interna ğŸ”

En la fase anterior de reconocimiento, mirabas la casa desde la calle. Ahora estÃ¡s en la cocina. Tienes una **perspectiva local**.

Debemos repetir el proceso de **Information Gathering**, pero ahora podemos ver:

- Impresoras y bases de datos locales.
    
- Servicios de virtualizaciÃ³n.
    
- Carpetas compartidas (Shares) que solo los empleados ven.
    

![[compromised-host.png]]

---

### 4. Pillaging (Saqueo): Buscando el Tesoro ğŸ´â€â˜ ï¸

El tÃ©rmino tÃ©cnico es _Pillaging_. AquÃ­ analizamos el rol del equipo que hackeamos. Â¿Es la laptop de la secretaria o el servidor del director financiero?

Analizamos configuraciones clave:

- **Interfaces y Rutas:** Â¿A quÃ© otras redes se conecta esta mÃ¡quina?
    
- **DNS y ARP:** Â¿Con quiÃ©n "habla" esta mÃ¡quina frecuentemente?
    
- **Shares (Carpetas compartidas):** El lugar favorito para encontrar contraseÃ±as olvidadas en archivos de texto.
    

> **ğŸ“œ Ejemplo:** Imagina que encuentras una billetera (el sistema).
> 
> - **Information Gathering:** Miras la licencia de conducir para saber quiÃ©n es.
>     
> - **Pillaging:** Revisas los recibos, las fotos y las tarjetas para saber dÃ³nde compra, quiÃ©nes son sus amigos y cuÃ¡nto dinero tiene.
>     

> **ğŸ›¡ï¸ Nota de Seguridad:** Un hallazgo comÃºn aquÃ­ son las **polÃ­ticas de contraseÃ±as**. Si descubres que la polÃ­tica solo pide 8 caracteres y sin sÃ­mbolos, Â¡bingo! Las probabilidades de adivinar contraseÃ±as de otros usuarios se disparan.

---

### 5. Persistencia: Dejando la Puerta Entornada ğŸ”‘

Una vez que tienes el control, **no quieres perderlo**. Si el usuario reinicia la computadora o la conexiÃ³n falla, no querrÃ¡s tener que volver a lanzar el exploit (que a veces puede fallar o colgar el sistema).

Objetivo: Crear una vÃ­a de acceso trasera fiable.

Esto debe hacerse antes de intentar ataques mÃ¡s ruidosos.

> Ejemplo PrÃ¡ctico (Concepto):
> 
> En lugar de explotar una vulnerabilidad compleja cada vez, podrÃ­as crear un usuario nuevo legÃ­timo, robar una clave SSH, o programar una tarea (Scheduled Task) que te envÃ­e una conexiÃ³n cada dÃ­a. Es como hacer una copia de la llave de la casa.

---

### 6. Escalada de Privilegios: ConvirtiÃ©ndose en Dios âš¡

Entrar como un usuario normal ("Bob de contabilidad") estÃ¡ bien, pero nosotros queremos poder total.

- En **Linux**, buscamos ser **root**.
    
- En **Windows**, buscamos ser **Administrator** o **SYSTEM**.

![[escalada-privilegios.png]]
No siempre es un hackeo tÃ©cnico:

A veces, la escalada de privilegios es tan simple como encontrar un archivo Excel llamado "Claves.xlsx" en una carpeta compartida durante la fase de Pillaging, leer la contraseÃ±a del administrador y loguearse con ella. Eso tambiÃ©n cuenta.

---

### 7. ExfiltraciÃ³n de Datos: El Robo Final ğŸ“¤

Si el cliente quiere probar si sus datos estÃ¡n seguros, intentaremos sacarlos de la red. Pero cuidado, existen sistemas como **DLP** (Data Loss Prevention) diseÃ±ados para detectar si alguien intenta enviar nÃºmeros de tarjetas de crÃ©dito o datos mÃ©dicos fuera de la empresa.

#### ğŸ“œ Los Grandes EstÃ¡ndares y Regulaciones)

Las empresas deben proteger ciertos datos por ley. Debes conocer estas siglas:

- **ğŸ›ï¸ NIST (Instituto Nacional de EstÃ¡ndares y TecnologÃ­a)** _Es la "Biblia" de la ciberseguridad en EE.UU._ Su framework (NIST CSF) es el estÃ¡ndar de oro voluntario que la mayorÃ­a de las empresas intentan seguir para identificar, proteger, detectar, responder y recuperar.
    
- **âœ… CIS Controls (Centro de Control de Seguridad en Internet)** _La lista de tareas prioritaria._ A diferencia de otros que son muy teÃ³ricos, CIS te dice: "Haz estas 18 cosas tÃ©cnicas primero para evitar el 80% de los ataques". Son sÃºper prÃ¡cticos.
    
- **ğŸŒ ISO (OrganizaciÃ³n Internacional de NormalizaciÃ³n)** _El sello de calidad global._ EspecÃ­ficamente la familia **ISO 27000**. Si una empresa tiene esta certificaciÃ³n, significa que tiene un sistema de gestiÃ³n de seguridad formal, documentado y auditado. Es el lenguaje internacional de la confianza.
    
- **ğŸ’³ PCI-DSS (EstÃ¡ndar de Seguridad de Datos de la Industria de Tarjetas de Pago)** _La ley del dinero plÃ¡stico._ Si tu empresa toca, guarda o transmite nÃºmeros de tarjeta de crÃ©dito (Visa, Mastercard, etc.), debe cumplir esto estrictamente. Si fallas aquÃ­, te quitan la capacidad de cobrar.
    
- **ğŸ‡ªğŸ‡º GDPR (Reglamento General de ProtecciÃ³n de Datos)** _El guardiÃ¡n de la privacidad._ Una ley europea (pero de impacto mundial) que protege los datos de las personas. Es famosa por sus multas gigantescas si no respetas la privacidad del usuario.
    
- **ğŸ‘” COBIT (Objetivos de Control para la InformaciÃ³n y TecnologÃ­as Relacionadas)** _El puente entre IT y el Negocio._ Es un marco enfocado en el **Gobierno Corporativo**. Ayuda a que los "frikis" de seguridad y los directivos de negocios hablen el mismo idioma y alineen sus metas.
    
- **â˜ï¸ FedRAMP (Programa Federal de GestiÃ³n de Riesgos y Autorizaciones)** _La llave del gobierno._ Si eres una empresa de nube (como AWS o Google) y quieres venderle servicios al gobierno de EE.UU., necesitas esta certificaciÃ³n obligatoria.
    
- **ğŸš€ ITAR (Reglamento Internacional de TrÃ¡fico de Armas)** _Defensa extrema._ Regula artÃ­culos y servicios relacionados con la defensa y el espacio. Si trabajas con datos que caen bajo ITAR, solo ciudadanos de EE.UU. pueden verlos. Es seguridad nacional pura.
    
- **ğŸ“‹ AICPA (Instituto Americano de Contables PÃºblicos Certificados)** _Los auditores de la confianza._ Aunque suena a contabilidad, ellos definen los estÃ¡ndares **SOC 2**. Las empresas tecnolÃ³gicas (SaaS) usan los reportes SOC 2 para demostrarle a sus clientes que no son un desastre en seguridad.
    
- **âš¡ NERC CIP (Normas de ProtecciÃ³n de Infraestructuras CrÃ­ticas)** _Protegiendo la red elÃ©ctrica._ Son estÃ¡ndares obligatorios para asegurar la red elÃ©ctrica de NorteamÃ©rica. AquÃ­ no se protege dinero, se protege que no se apaguen las luces de todo un paÃ­s.


> ğŸ›¡ï¸ Nota de Seguridad CrÃ­tica:
> 
> NUNCA exfiltres datos reales de clientes sin permiso explÃ­cito y por escrito.
> 
> - **Lo correcto:** Crea un archivo falso (dummy data) con nÃºmeros de tarjeta de crÃ©dito falsos y trata de enviarlo a tu servidor.
>     
> - **Por quÃ©:** AsÃ­ pruebas si el sistema DLP detecta el patrÃ³n de tarjeta de crÃ©dito, pero no cometes un delito ni pones en riesgo datos reales.
>     

> **ğŸ’¡ Consejo Pro:** Siempre graba tu pantalla o toma capturas durante esta fase. Si logras acceder a datos sensibles, una captura del nombre del archivo y la ruta es suficiente evidencia ("Proof of Concept"). No necesitas descargar la base de datos entera para probar que es vulnerable.

---

### ğŸ“ Resumen para llevar

- **La Post-ExplotaciÃ³n es el "ahora quÃ©":** Se trata de entender el valor del sistema comprometido y usarlo como trampolÃ­n.
    
- **Sigilo vs. Ruido:** Las **Pruebas Evasivas** buscan evitar a los sistemas EDR y administradores vigilantes.
    
- **ConviÃ©rtete en Local:** Usa el **Pillaging** para entender la red desde adentro y encontrar credenciales olvidadas.
    
- **Persistencia es clave:** Asegura tu acceso antes de intentar nada arriesgado.
    
- **Ã‰tica ante todo:** Al probar la **ExfiltraciÃ³n de Datos**, usa datos falsos para probar los controles de seguridad sin violar la privacidad real.